<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Help – YHZ Crew Alerts</title>
  <link rel="stylesheet" href="https://yhz.app/style.css?v1" />
  <link rel="stylesheet" href="/help.css?v=6" />
</head>
<body>
  <div id="shared-header"></div>

<main class="page">
  <h1>YHZ Crew Alerts Help Center (Work in Progress)</h1>
  <p>Guides and answers for YHZ Crew Alerts. If you don't see what you are looking for please email hello@yhz.app.</p>

  <div class="toolbar">
    <div class="search">
      <input id="q" type="search" placeholder="Search help…" aria-label="Search help" />
    </div>
  </div>

  <div class="filters">
    <label for="cat">Category</label>
    <select id="cat">
      <option>All</option>
      <!-- options are injected by JS -->
    </select>
  </div>

  <div id="list" class="cards"></div>
</main>


  <div id="shared-footer"></div>

  <!-- footer injection flags must come BEFORE inject.js -->
  <script>window.SUPPRESS_HEADER = true; window.SUPPRESS_FOOTER = false;</script>
  <script src="https://yhz.app/inject.js?v1" defer></script>
  <script src="/site.js" defer></script>

  <!-- search + categories -->
<script defer>
  let ARTICLES = [];
  const FILTER = { q: "", cat: "All" };

  const listEl = document.getElementById('list');
  const qEl    = document.getElementById('q');
  const catEl  = document.getElementById('cat');

  function render() {
    const q = FILTER.q.trim().toLowerCase();
    const cat = FILTER.cat;

    const filtered = ARTICLES.filter(a => {
      const inCat = (cat === 'All') || (a.category === cat);
      const hay   = (a.title + ' ' + (a.summary || '')).toLowerCase();
      const inTxt = !q || hay.includes(q);
      return inCat && inTxt;
    });

    listEl.innerHTML = filtered.length
      ? filtered.map(a => `
          <a class="card" href="/article.html?slug=${encodeURIComponent(a.slug)}">
            <h2>${a.title} <span class="badge">${a.category}</span></h2>
            <p>${a.summary ? a.summary : ''}</p>
          </a>
        `).join('')
      : `<p class="muted">No results. Try a different search or category.</p>`;
  }

  function getCategories() {
    return Array.from(new Set(ARTICLES.map(a => a.category || 'Other'))).sort();
  }

  function buildCategoryDropdown(cats) {
    // Keep "All" first, then sorted categories
    const opts = ['All', ...cats];
    catEl.innerHTML = opts.map(c =>
      `<option value="${c}">${c}</option>`
    ).join('');
    catEl.value = FILTER.cat;
  }

  qEl.addEventListener('input', (e) => { FILTER.q = e.target.value || ''; render(); });
  catEl.addEventListener('change', (e) => { FILTER.cat = e.target.value; render(); });

  (async () => {
    const res = await fetch('/content/help/_index.json', { cache: 'no-store' });
    const data = await res.json();
    ARTICLES = (data.articles || []).map(a => ({ ...a, category: a.category || 'Other' }));
    buildCategoryDropdown(getCategories());
    render();
  })();
</script>

</body>

</html>

